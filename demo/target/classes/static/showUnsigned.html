<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Baidu Map </title>
    <style type="text/css">
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #container {
            height: 100%;
        }

        /* 样式定义 */
        #custom-button {
            position: absolute; /* 绝对定位 */
            top: 30px; /* 与顶部的距离 */
            left: 30px; /* 与左侧的距离 */
            background-color: #0074a2; /* 背景颜色 */
            color: #fff; /* 文字颜色 */
            padding: 10px 20px; /* 内边距（上下，左右） */
            border: none; /* 去掉边框 */
            cursor: pointer; /* 鼠标指针样式 */
            border-radius: 5px; /* 边框圆角 */
            font-size: 24px; /* 文字大小 */
            z-index:1000;
            opacity: 0.8; /* 设置透明度（0.7 表示 70% 不透明） */
            width: 160px; /* 设置按钮宽度 */
            height: 70px; /* 设置按钮高度 */
            /*cursor: url('C:/Users/admin/Desktop/IMG_20231013_164230.jpg'), auto;*/
        }


    </style>
    
</head>

<body>
    
    <div id="container"></div>
    <button id="custom-button">登录</button>
    <!-- 自定义按钮 -->
    <!--button id="custom-button">去登录</button-->
</body>
<script type="text/javascript"
    src="https://api.map.baidu.com/api?v=1.0&type=webgl&ak=tg72P5G7323hTWbtxkAEMPqD9Gw7DSz7"></script>
<script>
    var map = new BMapGL.Map("container");
    var point = new BMapGL.Point(116.404, 39.915);
    map.centerAndZoom(point, 15);
    map.enableScrollWheelZoom(true);
    map.setHeading(64.5);
    map.setTilt(73);

    var markers = []; // 用于存储所有的marker
    var markerIdCounter = 0; // 用于生成唯一的marker ID

    // 添加点击事件到按钮
    var button = document.getElementById("custom-button");
    var JsUrl;
    button.addEventListener("click", function() {
        window.location.href = "sign.html";
    });

    fetch('/api/spots/getAllSpots', {
      		method: 'GET',
      		headers: {
        	'Content-Type': 'application/json'
            },
    	})
        .then(response => {
            if (response.status == 200) {
                return response.json();
            } else {
                throw new Error('失败');
            }
        })
        .then(data =>{
            data.forEach(coordinate => {
                var point = new BMapGL.Point(coordinate.lng,coordinate.lat);
                var marker = new BMapGL.Marker(point);
                map.addOverlay(marker);
                marker.addEventListener("click", function () {
                    localStorage.setItem("lng",coordinate.lng);
                    localStorage.setItem("lat",coordinate.lat);
                    if(localStorage.getItem("userID")) {
                        window.location.href = "displaySigned.html";
                    }
                    else
                        window.location.href = "displayUnsigned.html";
                });
            })
        })
        .catch(error => {// 处理失败或请求错误
            alert("失败");
        });


    /*fetch('/api/guests/map', {
        method: 'GET',
        headers: {
            'Accept': 'application/json'
        }
    })
    .then(response => {
        return response.json();
    })
    .then(url => {
        if (response.url) {
            JsUrl = response.url;
        } else {
            throw new Error('获取数据失败');
        }
    })
    .catch(error => {
        alert("请求失败！");
    });
    JsUrl = "c:\\Users\\admin\\Desktop\\软件工程\\data\\.js\\public.js";
    // 创建一个新的script标签
    var script = document.createElement("script");
    // 设置script标签的src属性为获取到的URL
    script.src = JsUrl;
    // 将script标签添加到<body>元素的末尾，即在所有已存在的script标签之后
    document.body.appendChild(script);*/
</script>
<!--script type="text/javascript" src="c:\Users\admin\Desktop\软件工程\data\.js\public.js"></script-->
</html>
